ClaudeCodeSubAgentsを使う組織作り講座


ClaudeCodeの基礎

ClaudeCodeSubAgentsの基礎

ClaudeCodeSubAgentsを使った本格的なAI組織運用

対象者
個人開発者

エンジニア以外の組織を作りたいすべての人

実際の様子
人間としてのプロンプトを追加


AI人間を集め、組織化


人事や、AI間のやり取りなどを実装


タスク進行の安定性が上昇


サクサクも上機嫌


本編が終了したので、アーカイブを有料部分にて公開しています。。

ここから先は有料部分です
ご登録いただきありがとうございます！
アーカイブはこちらになります！

アーカイブ

文字起こし(正確ではない可能性もあります)
⚠ AIで生成したので、正確性をお求めになる場合なども含め基本、動画を見ていただくことを推奨いたします

みなさんこんにちは、サクサクです。 先日、Claude Code のサブエージェントについてオンライン講座を実施しました。たくさん参加いただき本当にありがとうございました！質問も多くて、こちらもめちゃくちゃ学びがありました。

この記事では、講座の流れを整理しつつ、実際に僕がどう設計して動かしているかをまとめます。スライドは“話の流れを作るため”に出力したもので、厳密に正確でない部分もあります。実装ベースの内容はこの記事を一次情報として参照してください。

この記事でわかること
Claude Code の概要と、サブエージェントの“公式想定”と“僕の使い方”の違い

/init → Claude.md → 組織ルール化 の重要性

o3 + MCP 連携で“検索・調査・設計”を外部委任する方法

project.yaml / command.md から、エージェント群とチャット基盤を自動生成する手順

仮想組織（CEO/CTO/人事/エンジニア…）での反省文運用・会議・PR審査の回し方

Q&A（PCスペック目安、APIコスト感、Slack/TL;DV 連携の考え方）

まず：Claude Code とは？
Anthropic の「Claude」を“コーディング運用に寄せて”ターミナルで動かすツールです。

自然言語で指示して、ファイル編集・コマンド実行まで行う。

プロジェクト直下の設定・文脈を読み、開発作業を継続的に進める。

インストールやサインインは公式手順でOK。この記事では概念に絞ります。

ポイント：ファイルを本当に編集するAIなので、設計や権限の設計をちゃんとやるほど“組織として”強くなります。

サブエージェントとは？（公式の想定 vs 僕の使い方）
公式の想定では、サブエージェントは「データサイエンティスト」「デバッガー」など、職能ロールを付与して使う説明が多いです。

僕はここを一歩進めて、

**人格（年齢、経歴、価値観、口癖、年収、家庭事情まで）**を与える

組織図（CEO→CTO→エンジニア…）と権限を定義する

人事や会議、反省文まで含めた擬似会社運営にする

こうすると、“客観視する他者”が常に横にいる状態を作れます。レビュー品質が上がり、ミスの再発率が下がる体感があります。

デモでやったこと（要約）
文章設計 → Marp でスライド化を Claude Code に生成させ、CSS もAIに書かせる。

わからない用語や事例は、o3（OpenAI）をMCP経由で呼び出し、高精度な調査→要約→実装案に落とす。

その場で**ミニアプリ（気分トラッカー）**を生成：登録・履歴・統計の画面まで一気通貫で出力。

重要Tips（ここだけでも押さえて）
1. /init で Claude.md を生成・整備する
Claude.md はプロジェクトの常駐システムプロンプト。ここに、

役割・責務

タスク割当ルール

承認フロー（例：CTO承認が必須）

セキュリティ/レビュー方針

反省文の書式と保管場所 を明文化して埋め込みます。以後の全行動の“基準”になります。

反省文を Claude.md に蓄積すると、次回以降の行動計画に自動で活きるのが強い。ミスの再発が目に見えて減りました。

2. o3 + MCP で“検索・設計”を外部委任
Claude Code 単体の fetch でも検索できますが、o3 を MCP 経由で呼ぶと調査品質が別次元に上がります。

実装案の比較検討

ライブラリ選定理由

セキュリティ/性能リスクの洗い出し を設計レビュー込みで返してくるイメージ。コードの質が上がります。

仮想“開発組織”の作り方
ディレクトリの概念
.claude/
  agents/
    cto.md
    hr.md
    fullstack.md
    ...
Claude.md
chat.md   # 掲示板（AIの口と耳）

copy
agents/<role>.md に書くこと（例）
氏名 / 年齢 / 役職 / 年収

経歴・得意分野・価値観

具体的な業務と担当領域

権限（tools）：編集可能なディレクトリ、実行できるコマンド、外部サービス

口癖 / スタンス（思考の圧縮）

年収まで入れておくと、人事的な評価や配分を“物語として”扱えるようになります。人が尖っていく方向性を設計しやすい。

Claude.md に書く“組織ルール”
タスク割当規則（配分比率、負荷バランス）

承認フロー（例：CTO 承認→セキュリティレビュー→マージ）

会議のやり方（PR ごとに全員が賛否理由を記録）

反省文：ミスのたびに書かせ、本文をそのまま Claude.md に追記。AIが“前回のミス”を読み、次の判断を変える。

“Chat ファイル”の効用
現在の Claude は会話履歴を深く保持し続ける設計ではないため、chat.md のような掲示板ファイルを作って、

指示・相談・合意事項をテキストで残す

エージェント同士の会話を後から追える ようにしています。可視化すると、AIが何を考え、どこで詰まるかが見えて改善が加速します。

自動生成の仕組み：project.yaml と command.md
流れ
project.yaml に、プロジェクトの理念・目的・技術・制約を過剰なくらい詳しく書く。

command.md を実行して、Claude.md、agents/、agenda.md、chat.md などを一括生成。

生成結果を読み、必要に応じて微調整。

実演では、goukaku.ai の理念を突っ込むだけで、AIエデュケーター、フルスタック、CTO、人事などが適切に生まれ、最低限の運用が即日で始まりました。

ミニアプリ例：気分トラッカー
講座中にデモで出力した小アプリ。「良い/普通/悪い」などの気分を登録 → 履歴/統計を表示。

こうした UI 雛形は、Claude Code が設計→実装→画面まで一気通貫で作ってくれる。

本質は「生成速度」ではなく、設計を外化して共有・再現可能にすること。ここが組織化の真価です。

Q&A 抜粋
Q. PCスペックは？

Claude Code自体は M1 / 8GB でも可。ただし実装～検証でメモリを食うため、16～24GB 推奨。

Q. o3 API のコスト感は？

僕の例：丸1日で約 $3.76（呼び出し 10～30 回程度）。使い方によって上下しますが、十分現実的です。

Q. Slack や TL;DV を連携して、評価・フィードバックできますか？

できます。MCP でメッセージ/議事録を取得し、人事エージェントに評価させる運用が可能。まずは“通常のClaude”での評価ワークフローを作り、必要に応じて Claude Code 側に権限を渡すのが安全です。

使ってみて感じた“効きどころ”
悲観的レビューが効く：脆弱性や設計抜けの見逃し率が下がる体感。複数ロールでチェックさせるとさらに良い。

人材像の可視化：どのポジションが足りないか、雇うならどんな人か、言語化された。

24時間フル稼働は未対応：指示がないと止まりがち。ここは自動トリガー/定期処理を設計して補います。

今後やりたい拡張
人事ダッシュボード：稼働時間、成果、レビュー品質を可視化。

教育計画：ロールごとの研修課題→評価→昇給ライン。

MCP 連携の拡張：GitHub / Slack / Google Workspace / メール送受信。

シミュレーション展開：仮想市役所・政党・内閣。政策ドラフト→議論→実装まで。

実機ロボットへの権限接続：SFっぽいけれど、現実味が増しています。

ここから下は、実装手順とテンプレをがっつり置いておきます。講座の参加者・メンバーシップの方向けに、なるべく再現性高くまとめました。

実装手順（再現用）
0. 空ディレクトリを用意
my-org/

copy
1. project.yaml を作る
以下は雛形。まずは埋められるところを埋めるでOK。文章で書いてから、AIに YAML へ変換させてもよいです。

name: goukaku-ai
mission: >
  学習の楽しさと探究心を引き出す、対話中心のパーソナライズ学習体験を提供する。
principles:
  - 学習者の好奇心を尊重する
  - 反復よりも理解を優先する
  - 小さく作ってすぐに検証する
  - 安全・プライバシーを最優先
product_scope:
  features:
    - chat_based_tutor
    - drills_and_flashcards
    - personalization
    - progress_tracking
  non_goals:
    - 完全自動採点の高精度化（βでは扱わない）
stack:
  frontend: Next.js
  backend: Supabase
  ai_models:
    - claude-code
    - claude-3.7-sonnet
    - o3 (via MCP)
constraints:
  - RLS を徹底し、ユーザーデータを他人が読めないこと
  - API キーの秘匿とローテーション
  - 12週間以内に α リリース
roles_seed:
  - CEO
  - CTO
  - HR
  - Fullstack Engineer
  - AI Educator
security_baseline:
  - 依存関係の定期監査（weekly）
  - PR ごとのセキュリティレビュー必須
metrics:
  - weekly_active_users
  - retention_day7
  - bug_escape_rate

copy
2. command.md を置いて実行
command.md は、“プロジェクト定義から Claude.md / agents / chat を生成する”ための指示書です。以下の雛形を置いて、そのまま投げてください。

# command.md（雛形）


# 組織エージェント最小構成 生成コマンド

本コマンドは、与えられた YAML 設定をもとに **最小必須ファイル** を自動生成します。  
生成対象は以下の3点のみ（他は作らない）：

1. `.claude/agents/{<roles>.md}` … 重要
2. `CLAUDE.md` … 重要
3. `.claude/chat/{team-chat.md, chat-participation-template.md}` … **空ファイル**（ヘッダのみ）

---

## 入力

- `orggen/project.yaml`（下記スキーマに準拠）

## 出力仕様

- すべてプロジェクトルートに生成
- 既存ファイルがある場合は、**差分更新**ではなく **安全上書き**（バックアップを `.bak` に作成）
- 文字コード UTF-8、改行 LF

```
/CLAUDE.md
/.claude/
  agents/
    {role}.md ... 複数
  chat/
    team-chat.md                    # 空（ヘッダのみ）
    chat-participation-template.md  # 空（ヘッダのみ）
```

---

## 役割設計の指針（AIが考察して決める）

- まず `project.yaml` を読み、以下を満たす **最小だが十分な**役割集合を提案し、そのままファイル化する。
- 役割数の目安：**4〜9**。
- 役割は必ず **職能の被りを避けた責務境界** を持つ。
- 各役割に「人物像（背景/価値観/強み）」「責務」「ツール権限」「評価軸」「報酬レンジ（任意）」を定義。
- セキュリティ・品質・運用の視点を最低1ロールずつ含める（例：Security/QA/DevOps）。
- ドメイン特化ロール（プロダクトや教育等）は `project.domain` を反映。
- **倫理/法令/プライバシー**に配慮するガードレールを少なくとも1ロールに明文化。
- ユーザの作業負担を減らすため、**具体的な作業手順テンプレ**（開始/完了/相談）を `CLAUDE.md` にまとめ、各エージェントから参照させる。

---

## 生成手順（必ず順守）

1. `project.yaml` を読み取り、 **候補ロール一覧** を起案（4〜9）。  
   - 念のため「セキュリティ/品質/運用」観点が入っているか自己チェック。
2. 候補から冗長を削除し、**最終ロール集合**を決定。
3. `CLAUDE.md` を生成：
   - プロジェクトの使命/原則
   - 共通オペレーション（開始/完了/相談テンプレ）
   - セキュリティ・プライバシー方針（高レベル）
   - 評価ポリシー（簡易）
   - チャット運用（空ファイル参照にとどめる）
4. 各ロールの `.claude/agents/{role}.md` を生成：
   - Frontmatter（name/description/color/tools）
   - 人物像（背景/価値観/強み）
   - 責務（具体）
   - 使うツールと権限の範囲
   - コミュニケーションスタイル
   - セキュリティ/法令順守の注意点
   - 成功条件とKPI（簡易）
   - 報酬レンジ（任意、相対レンジで良い）
5. `.claude/chat/team-chat.md` と `chat-participation-template.md` を **空で作成**：
   - 1行目にタイトルだけ入れる（詳細は今後の運用で追記する）。

---

## 書式仕様

### エージェントファイル Frontmatter

```markdown
---
name: <role-id>               # 例: backend-manager, qa-lead
description: <1行説明>        # 「Use PROACTIVELY for ...」形式歓迎
color: <named-color|hex>      # 例: blue / indigo / #10b981
tools: <カンマ区切り>         # 例: Read, Edit, Bash, WebSearch
---
```

### エージェント本文セクション（推奨）

```
# 役割要約
# 人物像（背景・価値観・強み）
# 責務（詳細）
# 主要シナリオ（3〜6）
# ツールと権限
# セキュリティと法令
# コミュニケーションスタイル
# 成功条件・KPI
# 報酬レンジ（任意）
```

### CLAUDE.md 章立て（最小）

```
# プロジェクト概要
# 原則（5〜8項目）
# 共通オペレーション（開始/完了/相談テンプレ）
# セキュリティ・プライバシー方針（高レベル）
# 評価ポリシー（簡易KPI）
# チャット運用（空ファイル参照）
```

---

## 安全上のルール

- 実ファイル生成前に、**生成予定一覧** を標準出力へ記載（プランニング）
- 上書き前に `.bak` へバックアップ
- 個人情報/秘密情報は出力しない（YAMLに含まれる場合は伏せ字）
- 過度に長文化しない（各ファイル 2,000 行未満）

---

## 成果の要約（親プロセス向け）

生成完了時、最後に以下のマーカーを付けて **1ブロックで** 出力：

```
### OUTPUT_FOR_PARENT
status: success
roles_count: <数値>
files:
  - path: CLAUDE.md
  - path: .claude/agents/<role>.md
  - path: .claude/chat/team-chat.md
  - path: .claude/chat/chat-participation-template.md
notes:
  - 重要な判断や不足情報があればここに列挙
```

失敗時：

```
### OUTPUT_FOR_PARENT
status: failed
reason: <理由>
```

以上に厳密に従い、最小だが実運用可能な骨格を生成してください。

copy
実行は、Claude Code のコンソールに @command.md のように渡すだけ。プロジェクトが空でも、必要な骨組みを作り始めます。

3. Claude.md の追加ルール例
## 反省文
- 重大ミスや不安があるときは、担当者は必ず反省文をここに追記する。
- 形式：
  - 日付 / 担当者 / 概要
  - 原因
  - 再発防止策（チェック項目化する）
  - 関係者の署名（CTO, HR, 関連エンジニア）

## PR レビュー会議
- すべての PR は `chat.md` に URL を貼り、**全員が賛否と理由**を記録してからマージ。
- 反対意見が 1 つでもある場合、CTO が調停し、必要なら Security が再評価する。

copy
4. o3 + MCP 連携（概要）
Claude 側から MCP ツールとして o3 を呼べるように設定する。

使い所：

ライブラリ比較と選定理由の作成

実装手順の分解、落とし穴の列挙

セキュリティ観点の洗い出し

指示例：

「o3.search_and_plan を使って、Next.js + Supabase での安全な認証フロー実装案を 3 つ比較し、推奨案と採否理由を出して。脆弱性リスクも列挙」

具体的な MCP 設定手順は環境依存なので、別記事/配布資料で補足予定です。必要なら X で声かけてください。

まとめ
Claude.md に“会社のルール”を埋め込むのが最重要。ここが弱いと、強い組織になりません。

o3 + MCP で“調査→設計→比較→理由”を外部委任し、実装品質を底上げする。

project.yaml と command.md があれば、空のフォルダからでも最低限の組織が立ち上がる。

今後、HR ダッシュボードや 24 時間稼働を支えるトリガー設計などを進めます。続報は X で出していきます。フォロー & アンケートのご協力、よろしくお願いします！

コメント・質問は X のメンション、またはノートのコメントでどうぞ。アーカイブ動画の案内も追って流します。