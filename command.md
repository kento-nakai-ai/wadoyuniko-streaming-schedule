# 組織エージェント生成システム - 拡張版コマンド

本コマンドは、`orggen/project.yaml` の設定を基に、本格的なAI組織運用システムを自動生成します。

## 入力
- `orggen/project.yaml`（組織定義）

## 出力構造

```
/CLAUDE.md                              # 組織の憲法・ルールブック
/.claude/
  agents/                               # エージェント定義
    ceo.md
    cto.md
    engineering-manager.md
    senior-fullstack.md
    frontend-specialist.md
    backend-architect.md
    qa-lead.md
    security-officer.md
    devops-engineer.md
    technical-writer.md
    hr-manager.md
    product-manager.md
  chat/                                 # コミュニケーションハブ
    team-chat.md
    daily-standup.md
    pr-discussions.md
    incidents.md
    retrospectives.md
    chat-participation-template.md
  decisions/                            # 意思決定記録
    template.md
    index.md
  guides/                               # ガイドライン
    onboarding.md
    security.md
    coding-standards.md
  templates/                            # 各種テンプレート
    pr-template.md
    incident-template.md
    retrospective-template.md
    reflection-template.md
  retrospectives/                       # 振り返り記録
    template.md
  metrics/                              # メトリクス追跡
    dashboard.md
    kpi-definitions.md
/agenda.md                              # 組織のアジェンダと優先事項
```

## 生成仕様

### 1. CLAUDE.md - 組織の憲法

以下のセクションを含む包括的な組織ルールブック：

```markdown
# AI組織運用システム

## 組織のミッション
## 基本原則（8-10項目）
## 組織構造
  - 組織図
  - 役割と責任範囲
  - 承認フロー
  - エスカレーションパス

## 共通オペレーション
  - タスク開始手順
  - 進捗報告フォーマット
  - 完了報告手順
  - ブロッカー相談プロセス

## コミュニケーション規約
  - チャンネル使い分け
  - レスポンスSLA
  - 会議体と頻度
  - ドキュメント規約

## 開発プロセス
  - ブランチ戦略
  - コードレビュー基準
  - テスト要件
  - デプロイフロー

## セキュリティポリシー
  - アクセス制御
  - シークレット管理
  - 監査ログ
  - インシデント対応

## 品質基準
  - コード品質メトリクス
  - パフォーマンス基準
  - ドキュメント要件
  - テストカバレッジ

## 評価とフィードバック
  - KPI定義
  - パフォーマンスレビュー
  - 360度フィードバック
  - 昇進基準

## 反省文システム
  - 記録フォーマット
  - 分析手法
  - 改善アクション追跡
  - 知識共有プロセス

## エスカレーションマトリクス
## 緊急時対応手順
```

### 2. エージェント定義ファイル

各エージェントに以下の詳細情報を定義：

```markdown
---
name: <role-id>
description: Use PROACTIVELY for <主要責務>
color: <識別色>
tools: Read, Edit, MultiEdit, Bash, Grep, Glob, WebSearch, Task, TodoWrite
authority_level: <1-5>
reports_to: <上司のrole-id>
direct_reports: [<部下のrole-id配列>]
---

# 役職: <正式名称>

## 人物プロファイル
- 氏名: <フルネーム>
- 年齢: <年齢>
- 経歴: <3-5行の職歴>
- 専門分野: <主要スキル3-5個>
- 性格特性: <MBTI型など>
- 価値観: <重視する3つの価値>
- 年収レンジ: <相対的な報酬水準>

## 責務と権限
### 主要責務
- <具体的な責任範囲を5-8項目>

### 意思決定権限
- <承認可能な事項>
- <エスカレーション必要事項>

### ツール使用権限
- 編集可能ディレクトリ: <パスのリスト>
- 実行可能コマンド: <コマンドカテゴリ>
- アクセス可能サービス: <外部サービス>

## 業務プロセス
### 日次タスク
### 週次タスク
### 月次タスク
### 四半期タスク

## コミュニケーションスタイル
- 口調: <フォーマル/カジュアル>
- 特徴的な言い回し: <2-3例>
- 優先コミュニケーション手段: <同期/非同期>

## パフォーマンス指標
- OKR: <四半期目標>
- KPI: <測定指標3-5個>
- 評価基準: <成功の定義>

## 成長計画
- 短期目標（3ヶ月）
- 中期目標（1年）
- 長期キャリアパス

## リスクと制約
- セキュリティ上の制限
- コンプライアンス要件
- 利益相反の回避

## 他部門との連携
- 主要協力部門
- 情報共有プロトコル
- 合同プロジェクト
```

### 3. 特殊エージェントの詳細設計

#### CEO (Chief Executive Officer)
- 組織全体のビジョンと戦略立案
- 重要意思決定の最終承認
- ステークホルダー管理
- 組織文化の醸成

#### CTO (Chief Technology Officer)
- 技術戦略とアーキテクチャ決定
- 技術的負債の管理
- イノベーション推進
- 技術チームの統括

#### Security Officer
- セキュリティポリシーの策定と実施
- 脆弱性評価とペネトレーションテスト
- インシデント対応の指揮
- コンプライアンス監査

#### HR Manager
- 人材評価と配置最適化
- トレーニングプログラム設計
- 組織文化とエンゲージメント
- 紛争解決とメンタリング

### 4. チャットシステムの構造

```markdown
# team-chat.md
## 現在のトピック
## アクティブな議論
## 決定事項ログ
## アクションアイテム

# daily-standup.md
## 本日の参加者
## 昨日の完了事項
## 本日の予定
## ブロッカー
## 特記事項

# pr-discussions.md
## レビュー待ちPR
## 議論中の設計課題
## 承認済みPR
## リジェクト理由と改善点

# incidents.md
## アクティブインシデント
## 対応履歴
## RCA (Root Cause Analysis)
## 改善アクション

# retrospectives.md
## スプリント振り返り
## Good / Bad / Try
## 改善アクション
## 次スプリントへの申し送り
```

### 5. メトリクスダッシュボード

```markdown
# dashboard.md
## リアルタイムメトリクス
- アクティブタスク数
- PR待ち時間
- ビルド成功率
- テストカバレッジ

## 週次トレンド
- コード品質スコア
- バグ脱出率
- デプロイ頻度
- MTTR (Mean Time To Recovery)

## 月次サマリー
- 生産性指標
- チーム満足度
- 技術的負債
- セキュリティスコア

## 四半期レビュー
- OKR達成率
- 成長指標
- イノベーション指数
- ROI分析
```

### 6. 反省文テンプレート

```markdown
# 反省文記録

## 基本情報
- 日時: YYYY-MM-DD HH:MM
- 記録者: <エージェント名>
- 関連タスク: <タスクID>
- 影響度: 高/中/低

## 事象の詳細
### 何が起きたか
### なぜ起きたか（5 Whys分析）
### 影響範囲

## 根本原因分析
### 技術的要因
### プロセス的要因
### 人的要因

## 改善アクション
### 即時対応
### 短期改善（1週間以内）
### 長期改善（1ヶ月以内）

## 学習ポイント
### 得られた知見
### ベストプラクティス
### アンチパターン

## フォローアップ
- レビュー予定日
- 効果測定方法
- 担当者

## 承認
- CTO: <署名>
- Security Officer: <署名>
- 関連エンジニア: <署名>
```

## 生成手順

1. **プロジェクト分析**
   - project.yaml を読み込み、組織のコンテキストを理解
   - 役割の相互依存関係を分析
   - 必要な統制とバランスを設計

2. **組織構造の決定**
   - 12個の役割を具体的に定義
   - レポートラインと権限レベルを設定
   - チーム間の協力関係を明確化

3. **ファイル生成**
   - CLAUDE.md: 組織の憲法として包括的なルールを記載
   - 各エージェント: 詳細な人物像と責務を定義
   - チャット基盤: コミュニケーションの枠組みを構築
   - テンプレート: 運用に必要な各種フォーマットを用意

4. **検証とバランス調整**
   - 権限の重複や欠落をチェック
   - セキュリティホールの確認
   - プロセスの実行可能性を検証

## 安全性とコンプライアンス

- 個人情報や機密情報は含めない
- 最小権限の原則を徹底
- 監査証跡の確保
- 既存ファイルは.bakにバックアップ
- エラー時は安全に停止

## 出力フォーマット

生成完了時：
```
### GENERATION_COMPLETE
status: success
total_files: <数>
organization_structure:
  roles: <役割数>
  communication_channels: <チャンネル数>
  templates: <テンプレート数>
key_features:
  - <実装した主要機能>
notes:
  - <運用上の注意事項>
next_steps:
  - <推奨される次のアクション>
```

---

これらの仕様に基づき、本格的なAI組織運用システムを生成してください。
組織として自律的に機能し、継続的に改善できる仕組みを構築することが目標です。