# 📺 Day 3: Difyで作るノーコードAIアプリ
## 配信日：8月16日（土）20:00-21:30

---

## 🎯 配信ゴール
参加者が90分後に達成できること：
1. Difyの環境構築（Docker/クラウド版）を完了
2. ワークフロービルダーでAIアプリを設計
3. 実用的なAIアプリを3つ完成・デプロイ

---

## ⏰ タイムスケジュール

### 19:55-20:00 【配信準備】
- Dify画面の準備
- Docker Desktop起動確認
- デモアプリの動作確認

### 20:00-20:05 【オープニング】
```
「こんばんは！土曜の夜もAI開発しましょう！
今日はコードを1行も書かずに
本格的なAIアプリを作ります！」
```
- 2日間の振り返り（30秒）
- ノーコードの可能性
- 本日の成果物プレビュー

### 20:05-20:20 【環境構築】

#### 選択肢1：クラウド版（推奨・簡単）
```
1. https://dify.ai にアクセス
2. "Start for Free"をクリック
3. Googleアカウントでサインアップ
4. ワークスペース作成
```

#### 選択肢2：Docker版（ローカル環境）
```bash
# Dockerインストール確認
docker --version
docker-compose --version

# Difyクローン
git clone https://github.com/langgenius/dify.git
cd dify/docker

# 環境変数設定
cp .env.example .env

# 起動（初回は5分程度）
docker-compose up -d

# アクセス
# http://localhost:3000
```

#### APIキー設定
```
設定 > モデルプロバイダー から追加：
- OpenAI APIキー
- Claude APIキー（オプション）
- Google AI APIキー（昨日取得したもの）
```

⚠️ **トラブルシューティング**
- Docker起動しない → メモリ割当確認（4GB以上）
- ポート競合 → .envで`DIFY_PORT=3001`に変更
- APIエラー → キーの有効性確認

### 20:20-20:35 【基礎解説】

#### Difyの3つのアプリタイプ
```
1. チャットボット
   └─ 対話型AI、カスタマーサポート

2. テキスト生成
   └─ 文章作成、翻訳、要約

3. ワークフロー
   └─ 複雑な処理、API連携、自動化
```

#### ビジュアルワークフロービルダー
```
[入力] → [前処理] → [AI処理] → [後処理] → [出力]
   ↓         ↓          ↓          ↓          ↓
変数設定  テキスト   LLM呼出    フォーマット  API/画面
         クリーニング           変換
```

#### ノード種類と使い方
- **開始ノード**：入力パラメータ定義
- **LLMノード**：AI処理（GPT/Claude/Gemini）
- **条件分岐**：IF文のビジュアル版
- **HTTPリクエスト**：外部API連携
- **コード実行**：Python/JavaScript
- **終了ノード**：出力形式定義

### 20:35-21:10 【ハンズオン実装】

#### 🔨 実装1：カスタマーサポートBot（15分）

**アプリ設計**
```yaml
アプリ名: スマートサポートBot
タイプ: チャットボット

機能:
  - FAQ自動回答
  - 感情分析
  - エスカレーション判定
  - 多言語対応
```

**構築手順**
1. 新規アプリ作成 → チャットボット選択
2. プロンプト設定：
```
あなたは親切なカスタマーサポートです。

## 知識ベース
{knowledge_base}

## 応答ルール
1. 丁寧で共感的な対応
2. 解決策を具体的に提示
3. 追加質問で問題を明確化
4. 解決できない場合は人間へエスカレーション

## 出力形式
回答: [具体的な解決策]
感情: [positive/neutral/negative]
信頼度: [0-100%]
エスカレーション: [必要/不要]
```

3. 知識ベース追加：
   - FAQ文書アップロード
   - 製品マニュアル追加
   - 過去の対応履歴

4. 変数設定：
   - `user_message`: ユーザー入力
   - `history`: 会話履歴
   - `language`: 言語設定

5. テスト実行 → デプロイ

#### 🔨 実装2：コンテンツ生成ワークフロー（15分）

**アプリ設計**
```yaml
アプリ名: AIコンテンツファクトリー
タイプ: ワークフロー

入力:
  - トピック
  - 文字数
  - トーン（カジュアル/フォーマル）
  - 形式（ブログ/SNS/メール）

出力:
  - 記事本文
  - タイトル案3つ
  - SEOキーワード
  - 画像プロンプト
```

**ワークフロー構築**
```
[開始]
  ↓
[変数取得]
  ├→ トピック
  ├→ 文字数
  ├→ トーン
  └→ 形式
  ↓
[LLM: タイトル生成]
  プロンプト: "{topic}について{tone}な{format}のタイトルを3つ"
  ↓
[LLM: 本文生成]
  プロンプト: "タイトル: {title}\n文字数: {length}\nトーン: {tone}"
  ↓
[並列処理]
  ├→ [LLM: SEOキーワード抽出]
  └→ [LLM: 画像プロンプト生成]
  ↓
[結果統合]
  ↓
[出力フォーマット]
```

**ノード詳細設定**
- 温度設定：クリエイティブ用は0.8
- トークン制限：本文は指定文字数×1.5
- エラーハンドリング：リトライ3回

#### 🔨 実装3：データ分析アシスタント（15分）

**アプリ設計**
```yaml
アプリ名: データインサイトAI
タイプ: ワークフロー + API

機能:
  - CSVデータ分析
  - グラフ生成
  - レポート作成
  - 異常検知
```

**実装ステップ**
```
[ファイルアップロード]
  ↓
[Pythonコード実行]
  import pandas as pd
  import json
  
  # CSVを解析
  df = pd.read_csv(file_path)
  
  # 基本統計量
  stats = df.describe().to_dict()
  
  # 相関分析
  correlations = df.corr().to_dict()
  
  output = {
    "rows": len(df),
    "columns": list(df.columns),
    "stats": stats,
    "correlations": correlations
  }
  ↓
[LLM: インサイト生成]
  プロンプト: 
  "以下のデータ分析結果から重要なインサイトを抽出:
   {analysis_result}
   
   1. 主要な発見
   2. 異常値や外れ値
   3. 改善提案
   4. 次のアクション"
  ↓
[並列処理]
  ├→ [グラフ生成API]
  └→ [レポートフォーマット]
  ↓
[最終出力]
```

#### 🔨 実装4：マルチエージェントシステム（10分）

**複数のAIが協力するシステム**
```
[ユーザー入力]
  ↓
[分類エージェント]
  └→ タスクタイプを判定
     ↓
[ルーティング]
  ├→ [専門エージェント1: コーディング]
  ├→ [専門エージェント2: デザイン]
  └→ [専門エージェント3: 分析]
     ↓
[統合エージェント]
  └→ 各結果を統合
     ↓
[品質チェックエージェント]
  └→ 最終確認
     ↓
[出力]
```

### 21:10-21:15 【応用・デプロイ】

#### APIとして公開
```python
# DifyアプリをAPIとして利用
import requests

API_KEY = "your-dify-api-key"
APP_ID = "your-app-id"

response = requests.post(
    f"https://api.dify.ai/v1/apps/{APP_ID}/completions",
    headers={"Authorization": f"Bearer {API_KEY}"},
    json={
        "inputs": {"topic": "AI開発"},
        "response_mode": "blocking"
    }
)

print(response.json())
```

#### Webhook連携
- Slack通知
- Discord Bot
- LINE Bot
- Zapier/Make統合

### 21:15-21:20 【Q&A】
よくある質問：
- Q: 無料プランの制限は？
- A: 月200メッセージ、3アプリまで

- Q: 作ったアプリは商用利用可能？
- A: 可能です。ライセンス確認を

- Q: コーディング知識は本当に不要？
- A: 基本機能は不要。高度なカスタマイズには有用

### 21:20-21:25 【まとめ・次回予告】

#### 今日のポイント
✅ Difyでノーコード開発を体験
✅ 4つの実用AIアプリ完成
✅ ワークフロー設計の基礎習得

#### 宿題
🎯 自分のアイデアでオリジナルAIアプリを1つ作成
- 業務効率化ツール
- エンタメ系アプリ
- 学習支援ツール

#### 次回予告
「明日はn8nで本格的な自動化を！
メール、スプレッドシート、SNS...
全部AIで自動化しちゃいます！」

### 21:25-21:30 【クロージング】
- 作成したアプリのテンプレート共有
- コミュニティでアプリ自慢大会
- 「明日の日曜も一緒に開発しましょう！」

---

## 📝 配信用チェックリスト

### 配信前
- [ ] Difyログイン確認
- [ ] デモアプリ3つ準備完了
- [ ] APIキー設定済み
- [ ] サンプルデータ準備
- [ ] 画面録画準備（デモ用）

### 配信中
- [ ] ドラッグ&ドロップをゆっくり
- [ ] ノード接続を視覚的に説明
- [ ] 実行結果の確認
- [ ] エラー時の対処法

### 配信後
- [ ] アプリテンプレート公開
- [ ] ワークフロー設計図共有
- [ ] FAQ作成

---

## 🎬 画面レイアウト案
```
┌────────────────────────────────────┐
│                                    │
│     Difyワークフロービルダー        │
│         （メイン表示）              │
│                                    │
├────────────────┬───────────────────┤
│ 顔出し（小）    │  実行結果/チャット  │
└────────────────┴───────────────────┘
```

---

## 💡 配信のコツ
1. **ビジュアル重視**：ノード接続をアニメーションで
2. **即座に結果確認**：作ったらすぐテスト
3. **失敗も見せる**：エラー対処も学習の一部
4. **実用性アピール**：「これで月10万円の案件取れます」
5. **参加型に**：「皆さんならどう設計しますか？」